### LeanGeo: Formalizing Competitional Geometry Problems in Lean

**信号源**：Moonshot AI、Numina、北京大学、多伦多大学  
**论文链接**：https://arxiv.org/abs/2508.14644

---

#### 一句话总结  
作者构建了首个可在 Lean 4 中严谨表达与验证奥赛级几何题的统一系统 LeanGeo，并配套发布了 122 题的 LeanGeo-Bench 基准，全面揭示了现有大模型在几何逻辑推理上的短板。

---

#### 论文摘要  
1. **背景**：几何证明历来是检验 AI 推理能力的难点，现有系统多在独立的几何形式体系内运行，难以与代数、数论等其他分支结合，且缺乏可机器验证的严谨性。  
2. **目标**：在 Lean 4 定理证明器内部，建立一个既能覆盖竞赛级几何知识、又能与 Lean 生态深度融合的通用几何库与评测集。  
3. **方法**  
   • 手工形式化 260 条高层几何定理，形成 LeanGeo 库；  
   • 基于国际奥数（IMO）与教材题目构建 LeanGeo-Bench，共 122 题；  
   • 设计 SMT + Lean 元编程的混合证明策略，并评测多款主流 LLM；  
   • 通过自动合成新定理 + 强化学习，初步提升模型在该环境中的证明能力。  
4. **发现**：现阶段顶尖 LLM 在 LeanGeo-Bench 的 pass@4 最高仅 27%，无一能解 62 道奥赛级难题（19 道 Olympic Problem + 43 道 IMO），显示出显著研究空间。  
5. **产出**：开源 LeanGeo 库与基准，供社区后续研究。

---

#### 核心方法  
**整体框架**  
1. **形式系统**：以 System E 公理为基底，增补 52 个几何对象定义与 9 条基础公理，形成可与 Mathlib 无缝衔接的坐标无关几何语言。  
2. **定理库构建**：人工自顶向下书写并机证 260 条“人类可读”的高阶定理，借助 LeanSMT 自动填补低层逻辑细节。  
3. **基准设计**：收集 IMO 2000-2025 全部几何题及教材、合成题目，生成 Lean 版本题库 LeanGeo-Bench，并给出 43 条机审通过的参考证。  
4. **评测流程**：以“一阶段 Fine-Eval”自动调用 Lean 服务器检验模型输出是否可被内核接受，确保零容忍错误。

**关键技术细节**  
• **SMT-增强 tactic（`esmt`）**：将本地上下文 + System E 公理一次性送入 CVC5 做不可满足性检查，若返回 unsat 则目标得证，简化分类讨论。  
• **命令缓存与依赖图**：对 SMT 命令做缓存，维护全局 metavariable 依赖图，避免重复翻译，显著加速推理。  
• **“注入式”强化学习**：先用 LLM 合成 5 000 条新定理-证明对，经 Lean 验证后划分为激活集与提示集；再在 Kimina RL 框架中随机抽取 10 条定理放入 prompt，训练模型在嘈杂上下文中自选工具，成功率由 2.52% 提升至 10.92%。

---

#### 实验成果  
* **LLM 现状评测**  
  在 LeanGeo-Bench 上，GPT-o4-mini 的 pass@1 为 19.67%，Gemini 2.5 Pro 的 pass@4 为 27.05%；所有模型在 62 道奥赛级题目（OP 19 + IMO 43）上全部失利，凸显几何推理的困难度。  

* **库内 RL 提升**  
  经过两阶段 RL 训练，模型在内部验证集的整体证明成功率由 12.5% 提升到 40%，在公开基准的 pass@1 提升到 10.92%，证明“定理注入”策略有效。

---

#### 总结与反思  
* **结果总结**：LeanGeo 成功把依赖图形直觉的平面几何迁移进 Lean 的形式世界，提供了可重用、可扩展的高层定理库和严格评测基准，奠定了跨领域数学自动化的基础。  
* **局限性**  
  1. SMT 证明目前依赖外部 CVC5 证书，尚未全部回放进 Lean 内核，完全可信度有待提升。  
  2. 通用 SMT 缺乏几何专用启发式，规模增大时性能下降。  
  3. RL 注入策略仍依赖长 prompt，模型对库中定理的“内化”程度有限。  
* **前沿展望**  
  • **研究方向**：借助 LeanGeo 统一语域，可探索“几何-代数-数论”跨域推理算法，或开发带几何启发的专用 SMT／面积法 tactic。  
  • **工业应用**：在 CAD、机器人路径规划、教育软件等场景，严谨几何证明可用于自动验证设计正确性、生成可交互证明；LeanGeo 让这一流程更可控。  
  • **学科意义**：几何一直是自动定理证明的“硬骨头”。LeanGeo 通过人类可读的定理库 + 机器可检的严格性，为 LLM 时代的“类人”数学推理提供了新的落脚点，预示大型模型将从“会算”进化到“会证”。